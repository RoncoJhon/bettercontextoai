"use strict";var b=Object.create;var p=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var E=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var x=(s,t)=>{for(var e in t)p(s,e,{get:t[e],enumerable:!0})},S=(s,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of M(t))!D.call(s,o)&&o!==e&&p(s,o,{get:()=>t[o],enumerable:!(i=C(t,o))||i.enumerable});return s};var _=(s,t,e)=>(e=s!=null?b(E(s)):{},S(t||!s||!s.__esModule?p(e,"default",{value:s,enumerable:!0}):e,s)),k=s=>S(p({},"__esModule",{value:!0}),s);var N={};x(N,{activate:()=>j,deactivate:()=>L});module.exports=k(N);var r=_(require("vscode")),c=require("fs"),f=require("path");function z(s){let t=s.map(e=>(0,f.normalize)(e).replace(/\\/g,"/"));return t.filter(e=>!t.some(i=>i!==e&&e.startsWith(i+"/")))}var y=class extends r.TreeItem{constructor(e,i,o,l,n=!1){super(e,o);this.label=e;this.fullPath=i;this.collapsibleState=o;this.isFolder=l,this.selected=n,this.iconPath=n?new r.ThemeIcon("check"):new r.ThemeIcon("circle-outline"),this.command={command:"extension.toggleSelection",title:"Toggle Selection",arguments:[this]}}selected;isFolder},w=class{constructor(t){this.rootPath=t}_onDidChangeTreeData=new r.EventEmitter;onDidChangeTreeData=this._onDidChangeTreeData.event;selectionMap=new Map;refresh(){this._onDidChangeTreeData.fire()}getTreeItem(t){return t}getChildren(t){let e=t?t.fullPath:this.rootPath,i=[];try{i=(0,c.readdirSync)(e).map(l=>{let n=(0,f.join)(e,l),u=(0,c.lstatSync)(n).isDirectory(),m=u?r.TreeItemCollapsibleState.Collapsed:r.TreeItemCollapsibleState.None,d=this.selectionMap.get(n)||!1;return new y(l,n,m,u,d)})}catch(o){console.error(o)}return Promise.resolve(i)}setSelectionRecursive(t,e){this.selectionMap.set(t,e);try{if((0,c.lstatSync)(t).isDirectory()){let i=(0,c.readdirSync)(t);for(let o of i){let l=(0,f.join)(t,o);this.setSelectionRecursive(l,e)}}}catch{}}updateParentSelection(t){let e=(0,f.dirname)(t);!e||e===t||(this.selectionMap.set(e,!1),this.updateParentSelection(e))}toggleSelection(t){let i=!(this.selectionMap.get(t.fullPath)||!1);t.isFolder?(this.setSelectionRecursive(t.fullPath,i),i||this.updateParentSelection(t.fullPath)):(this.selectionMap.set(t.fullPath,i),i||this.updateParentSelection(t.fullPath)),this.refresh()}async getSelectedItems(){let t=[],e=i=>{let o;try{o=(0,c.readdirSync)(i)}catch{return}for(let l of o){let n=(0,f.join)(i,l),a;try{a=(0,c.lstatSync)(n)}catch{continue}let u=a.isDirectory();this.selectionMap.get(n)&&t.push(n),u&&e(n)}};return e(this.rootPath),t}};function P(s,t){let e={},o=[".git","node_modules","dist","build","yarn.lock","package-lock.json",".yarnrc",".pdf",".png",".exe",".ico",".txt",".zip",".tar",".gz",".jpg",".jpeg",".svg",".gif",".mp4",".mp3",".wav",".avi",".webm",".mov"];if(t<=0)return e;let l;try{l=(0,c.readdirSync)(s)}catch{return e}for(let n of l){let a=(0,f.join)(s,n),u=(0,c.lstatSync)(a);if(!(o.find(d=>n.includes(d))||n.includes("test")||n.includes("ignore")||n.includes(".spec")||n.includes(".md")))if(u.isDirectory())e[n]=P(a,t-1);else if(u.size<=51200)try{let d=(0,c.readFileSync)(a,"utf8");e[n]={type:"file",content:d,path:a}}catch{e[n]={type:"file",content:"[Error reading file]",path:a}}else e[n]={type:"file",content:"[File too large, omitted]",path:a}}return e}function A(s,t=2){let e={};return s.forEach(o=>{if(!(0,c.existsSync)(o)){console.error("Path does not exist:",o);return}let l=(0,c.lstatSync)(o);if(l.isDirectory())e[o]=P(o,t);else if(l.size<=51200)try{let n=(0,c.readFileSync)(o,"utf8");e[o]={type:"file",content:n,path:o}}catch{e[o]={type:"file",content:"[Error reading file]",path:o}}else e[o]={type:"file",content:"[File too large, omitted]",path:o}}),e}function j(s){let t=r.workspace.workspaceFolders?r.workspace.workspaceFolders[0].uri.fsPath:"";if(!t){r.window.showErrorMessage("No workspace folder found.");return}let e=new w(t),i=r.window.createTreeView("fileSelector",{treeDataProvider:e,showCollapseAll:!0}),o=r.commands.registerCommand("extension.toggleSelection",a=>{e.toggleSelection(a)}),l=r.commands.registerCommand("extension.generateFileContentMap",async()=>{let a=await e.getSelectedItems();if(a.length===0){r.window.showErrorMessage("No files or folders selected.");return}let u=z(a),m=A(u,2),d="";function F(g){for(let T in g){let h=g[T];if(h&&h.type==="file"&&h.path){let I=(0,f.normalize)(h.path).replace(/\\/g,"/");d+=`"${I}":
`,d+=`// ${h.content}

`}else typeof h=="object"&&F(h)}}F(m);let v=(0,f.join)(t,"FILE_CONTENT_MAP.md");(0,c.writeFileSync)(v,d,"utf8"),r.window.showInformationMessage(`Saved file content map to ${v}`),r.workspace.openTextDocument(v).then(g=>{r.window.showTextDocument(g)})}),n=r.commands.registerCommand("extension.refreshFileTree",()=>{e.refresh(),r.window.showInformationMessage("File tree refreshed.")});s.subscriptions.push(o,l,n,i)}function L(){}0&&(module.exports={activate,deactivate});
